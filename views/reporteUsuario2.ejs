<!DOCTYPE html>

<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Reportes</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel='stylesheet' href='/stylesheets/reportes.css'/>
        <link href="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
        <script src="//maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

        <script src="https://unpkg.com/xlsx@0.16.9/dist/xlsx.full.min.js"></script>
        <script src="https://unpkg.com/file-saverjs@latest/FileSaver.min.js"></script>
        <script src="https://unpkg.com/tableexport@latest/dist/js/tableexport.min.js"></script>
    </head>
    <body style="overflow-y: hidden;">
        <!-- barra de navegacion -->
        <div class="topnav">
          <a href="/logout">Salir</a>
          <a  class="active" href="/reportes">Reportes</a>
          <a  href="/consultas">Consulta</a>
          <a  href="/inicio">Inicio</a>
          
        </div>

          <!-- contenedor de cajas -->
          
          <div  style="position: absolute; left: 250px; top: 80px;">
          <h3>Reporte de Usuarios</h3>
          <img src="/images/logo_forms.png"style="position: absolute; right:260px; bottom:5px;" width="45" height="45">
          </div>
          <button id="btnExportar"><img src="/images/download_icon.png"></button>

          <form action="/filtrarUs" method="POST" style="position: absolute; left:710px; top: 80px;" class="form-inline">
            <div class="form-group mx-sm-3 mb-2 ">
                <label for="inputPassword2" class="sr-only">Correo</label>
                <input style="width: 180px;" type="text" name="correo" class="form-control"  placeholder="Correo">
            </div>
            <div class="form-group mb-2">
                <label for="inputPassword2" class="sr-only">Fecha</label>
                <input style="width: 150px;" type="date" name="ingreso" class="form-control">
            </div>
            <div class="form-group mx-sm-3 mb-2">
              <label for="inputPassword2" class="sr-only">Puesto</label>
              <input style="width: 130px;" type="text" name="puesto" class="form-control"  placeholder="Puesto">
            </div>
            <button type="submit" class="btn btn-primary mb-2">Buscar</button>
          </form>
         

          <div class="contenedor-cajas">
            
            <table id="tabla" class="customTable">
                <thead>
                  <tr>
                    <th>Cedula</th>
                    <th>Nombre</th>
                    <th>Correo</th>
                    <th>Apellidos</th>
                    <th>Usuario Red</th>
                    <th>Telefono</th>
                    <th>Jefe</th>
                    <th>Ingreso</th>
                    <th>Retiro</th>
                    <th>Puesto</th>
                    <th>Host</th>
                    <th>Licencia</th>
                    <th>Equipo asociado</th>
                  </tr>
                </thead>
                <tbody>
                  <% usuarios.forEach(usuario =>{ %>
                  <tr>
                    <td><%= usuario.id %></td>
                    <td><%= usuario.nombre_usuario %></td>
                    <td><%= usuario.correo_usuario %></td>
                    <td><%= usuario.apellidos_usuario %></td>
                    <td><%= usuario.usuario_red %></td>
                    <td><%= usuario.telefono %></td>
                    <td><%= usuario.jefe %></td>
                    <td><%= usuario.ingreso %></td>
                    <td><%= usuario.retiro %></td>
                    <td><%= usuario.puesto %></td>
                    <td><%= usuario.host %></td>
                    <td><%= usuario.licencia %></td>
                    <td><%= usuario.equipo_placa %></td>
                  </tr>
                  <% }) %>
                </tbody>
              </table>
           

          </div>


    </body>

    <!-- script para exportar a excel -->
<script>
  const $btnExportar = document.querySelector("#btnExportar"),
      $tabla = document.querySelector("#tabla");

  $btnExportar.addEventListener("click", function() {
      let tableExport = new TableExport($tabla, {
          exportButtons: false, // No queremos botones
          filename: "Reporte_Usuarios", //Nombre del archivo de Excel
          sheetname: "Reporte_Usuarios", //TÃ­tulo de la hoja
      });
      let datos = tableExport.getExportData();
      let preferenciasDocumento = datos.tabla.xlsx;
      tableExport.export2file(preferenciasDocumento.data, preferenciasDocumento.mimeType, preferenciasDocumento.filename, preferenciasDocumento.fileExtension, preferenciasDocumento.merges, preferenciasDocumento.RTL, preferenciasDocumento.sheetname);
  });
</script>
</html>
